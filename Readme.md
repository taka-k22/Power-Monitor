# 低価格で簡単に作れる汎用停電アラート

## 概要

商用電源の停電を検知して **LINEに通知**します。  
実験用の観測機器（生物・化学・物理学実験など）の停電監視にご活用ください。

> ⚠️ **注意**：本装置の不具合によって重大な損失を被るような機器には使用しないでください。

---

## 原理

Raspberry PiのGPIO入力を用いて停電を検知します。  
商用AC100Vは直接入力できないため、**ACアダプターとUSBケーブルでDCに変換**してラズパイに入力し、電圧が約3Vを下回ると「停電」と判断します。

---

## 用意するもの

- Raspberry Pi Model 3 または 4  
- パススルー型モバイルバッテリー（充電しながら給電できるもの）  
- AC100V → USBアダプター ＋ USBケーブル（100均でOK）  
- 適当な導線 2本（USBからラズパイへ）  
- カッターナイフ（USBケーブルの切断・被覆むき用）  
- LINE アカウント  

> ※ Raspberry Pi のセットアップ（ディスプレイ・キーボード・Wi-Fi接続など）は済んでいる前提です。  
> ※ コンセントは2口必要です（電源用・検出用）。足りない場合は電源タップ等を利用してください。

---

## ステップ

1. **ラズパイ給電経路の構築**  
   モバイルバッテリーをコンセントに常時接続しつつ、ラズパイへ給電してください。停電時でもしばらく動作を維持できます。

2. **USBケーブルの加工**  
   片方を切断して赤と黒の線（または代表2本）を取り出し、導線をむきます。取り出した線に適当な導線を延長接続し、テープや熱収縮チューブで保護します。

3. **ラズパイとの接続**  
   USBケーブルの反対側をACアダプターへ、延長した線の端をラズパイのGPIOピンへ接続します。  
   - 赤い線 → 左上から7番目（GPIO 4）  
   - 黒い線 → 左上から8番目（GND）

4. **LINE Notifyトークンの取得**  
   1. [LINE Notify](https://notify-bot.line.me/ja/) にアクセス  
   2. ログイン → マイページ → 「トークンを発行」  
   3. トークン名を入力、通知先（1対1 or グループ）を選択  
   4. 表示された**アクセストークンをコピー**しておく

5. **（グループ通知の場合）グループにLINE Notifyを招待**  

6. **スクリプトの準備**  
   このリポジトリから `main.py` をダウンロードしてラズパイに移し、12行目の `TOKEN = "..."` に先ほどのトークンを貼り付けます。

7. **スクリプトの実行**  
   ACアダプターをコンセントに挿し、`main.py` を Thonny などで実行してください。  
   - コンソールに「正常監視中」と出たら成功  
   - ACアダプターを抜くと「停電が発生しています〜」というLINE通知が届きます

---

## おまけ（Tips）

- 多くのACアダプターにはコンデンサーが内蔵されており、**数秒間は通電が継続**するため、通知に少しラグがある場合があります。
- 通知の**間隔は main.py の39行目**で変更できます（単位：秒）。  
  デフォルトは `600`（10分）です。停電発生後、復旧までその間隔で繰り返し通知されます。

---

## ライセンス

MIT License
